To run the code the following packages need to be installed from GitHub:

  - First install https://github.com/egosv/twoPhaseGAS
  - Second install https://github.com/Rezastat/TPOrd

These packages can be installed in R using:
  devtools::install_github("egosv/twoPhaseGAS", ref="main")
  devtools::install_github("Rezastat/TPOrd", ref="main")

In the simulation folder, you can find the simulation files for the adjacent category logit model. To run simulations for different models,
follow these instructions:

For Cumulative Logit Model:
  - Set model_type to "Proportional_Odds".
  - Set fam to propodds(reverse = FALSE).

For Stopping-Ratio Logit Model:
  - Set model_type to "Stopping_Ratio".
  - Set fam to sratio(reverse = FALSE, parallel = TRUE).

The specific simulation files are as follows:

  - adcat_sim.R: Generates simulations based on SRS and Y-Bal strategies and analyzes them. (Single-wave approach)
  - adcat_R3R4.R: Generates simulations based on Z-Bal and YZ-Bal strategies and analyzes them. (Single-wave approach)
  - adcat_R5678data.R: Generates simulations based on Best-SRS, GA-Y-Bal, GA-Z-Bal, and GA-YZ-Bal strategies. (Single-wave approach)
  - adcat_R5678.R: Analyzes the simulations generated by adcat_R5678data.R. (Single-wave approach)
  - adcat_R5678data_2w.R: Generates simulations based on Best-SRS, GA-Y-Bal, GA-Z-Bal, and GA-YZ-Bal strategies. (Two-wave approach)
  - adcat_R5678_2w.R: Analyzes the simulations generated by adcat_R5678data_2w.R. (Two-wave approach)
  - true_coef_vals.R: Generates simulations to obtain the estimated coefficient values for the cumulative logit and adjacent category 
    models based on specified values for the stopping ratio model.
    
The analysis code for the case study:

  - ac_biopsy_1wave.R: Analysis using the single-wave approach
  - ac_biopsy_2wave.R: Analysis using the two-wave approach
  
The code for creating the tables and figures from the analysis results is included in the following files:

  - E123/E123analysis.R: The tables and figures related to Experiments 1-3.
  - E4/E4analysis.R: The tables and figures related to Experiment 4.
  - E5/E5analysis.R: The tables and figures related to Experiment 5.
  - E5/E5wave1results.R: The figures related to the first wave of Experiment 5.